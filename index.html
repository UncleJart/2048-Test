<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>2048 Test</title>
</head>
<style>
	.slide{
		display: flex;
		width: 1024px;
		height: 768px;
		background-color: lightgrey;
	}

	.game-field{
		margin: auto;
		display: flex;
		flex-flow: column wrap;
		justify-content: space-around;
		width: 480px;
		height: 480px;
	}

	.column{
		display: flex;
		flex-flow: row nowrap;
		width: 480px;
		justify-content: space-around;
	}

	.square{
		border: 1px solid black;
		width: 100px;
		height: 100px;
		background-color: grey;
	}
</style>
<body>
	<article class="slide">
		<div id="gameField" class="game-field">
			<div class="column">
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
			</div>
			<div class="column">
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
			</div>
			<div class="column">
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
			</div>
			<div class="column">
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
				<div class="square"></div>
			</div>
		</div>
	</article>
</body>
<script>
	var columnArray = [],
		valuesArray = [2,4];

//Utils
	function getRandom(min, max) {
		return Math.random() * (max - min) + min;
	}

	function getRoundedRandom(min,max,rounded){
		return rounded ?
				Math.round(getRandom(min,max)) :
				Math.floor(getRandom(min,max))
	}

	function decreaseArraySorting(a, b) {
		if (a > b){
			return -1;
		}
		if (a < b){
			return 1;
		}
		if (a = b){
			return 0;
		}
	}

	function increaseArraySorting(a, b) {
		if (a > b){
			return -1;
		}
		if (a < b){
			return 1;
		}
		if (a = b){
			return 0;
		}
	}
//Constructors
	function StartValues(options){
		this.startValues = [];

		options.values.forEach(function(item,i){
			var valueOpts = {};

			valueOpts.value = item;
			valueOpts.probability = options.prob[i];
			this.startValues.push(valueOpts);
		},this);
	}

	StartValues.prototype.getValue = function(){
		var startValue,
			probabilities = [],
			random = Math.random(),
			that = this;

		this.startValues.forEach(function(item){
			probabilities.push(item.probability);
		});

		probabilities.sort(decreaseArraySorting);

		probabilities.reduce(function(prev,curr,i){
			if (random > prev && random < (prev + curr)){
				startValue = that.startValues[i].value;
			}
			return prev + curr;
		},0);

		return startValue;

	};
//Objects for creating Game Field
	function RowArray(numOfRows,startValue){
		var counter;

		this.rowArray = [];

		for(counter = 0; counter < numOfRows; counter++){
			this.rowArray.push(startValue);
		}
	}

	function GameField(numOfRows,numOfColumns,elementValues){
		var counter,
			startValue = "";

		this.columnArray = [];
		this.startValue = startValue;
		this.elementValues = new StartValues(elementValues);

		for(counter = 0; counter < numOfColumns; counter++){
			this.columnArray.push(new RowArray(numOfRows,startValue));
		}
	}
//Methods of Game Field
	GameField.prototype.generateElements = function(){

		if (this.checkForEmptyGameField()){

		}

		/*this.columnArray.forEach(function(item){
			item.rowArray.forEach(function(item){

			});
		});*/
	};

	GameField.prototype.checkForEmptyGameField = function(){
		return this.columnArray.every(function(item){
			return item.rowArray.every(function(item){
				return item === this.startValue;
			},this);
		},this);
	};

	GameField.prototype.generateElementPosition = function(){
		var position = [],
			columns = this.columnArray.length - 1,
			rows = this.columnArray[0].rowArray.length - 1;

		position.push(getRoundedRandom(0,columns,true));
		position.push(getRoundedRandom(0,rows,true));

		return position;
	};

	GameField.prototype.checkIfElementIsEmpty = function(position){
		var column = position[0],
			row = position[1];
		return this.columnArray[column].rowArray[row] === this.startValue;
	};

	function generateNewElements(){

	}

	function printArray(){}

	document.addEventListener("keyup",function(event){
		var keyCode = event.keyCode;

		switch(keyCode) {
			case 38:
			{
				console.log("up");
				break;
			}
			case 40:
			{
				console.log("down");
				break;
			}
			case 37:
			{
				console.log("left");
				break;
			}
			case 39:
			{
				console.log("right");
				break;
			}
		}
	});

	gameField = new GameField(4,4,{values : [2,4], prob :[0.9,0.1]});

	gameField.columnArray.forEach(function(item){
		console.log(item.rowArray);
	});

	console.log(gameField.generateElementPosition());
	console.log(gameField.checkForEmptyGameField());

</script>
</html>